---
title: "Anscombe's quartet"
author: "Elena U"
format: html
editor: visual
fig-dpi: 300
---

## Квартет Энскомба (Anscombe's quartet)

```{r libs, echo=FALSE}
#| message=FALSE
library(tidyverse)
library(patchwork)
```

Квартет Энскомба представляет собой 4 набора данных с одинаковыми описательными статистиками (среднее, дисперсия, коэффициент корреляции), но с очень разными распределениями данных. Каждый набор содержит 11 значений (x, y). Francis Anscombe предложил эти наборы данных в 1973 году \[1\] в качестве иллюстрации важности полагаться не только на описательные статистики, но и визуализацию данных.

Этот набор данных встроен в R (вызвать можно просто набрав `anscombe` в консоли).

```{r}
#| code-fold: false
anscombe
```

Давайте попробуем посчитать описательные статистики самостоятельно.

```{r}
# посчитаем среднее
apply(anscombe, 2, mean)
# дисперсию
apply(anscombe, 2, var)
# коэффициент корреляции, привожу два варианта как посчитать, интересно, какой кажется проще
map2_dbl(anscombe %>% select(x1:x4), anscombe %>% select(y1:y4), ~cor(.x, .y))
map2_dbl(anscombe[1:4], anscombe[5:8], ~cor(.x, .y))

# еще простой способ отразить все описательные статистики - просто вызвать функцию summary
summary(anscombe)
```

Итак, можно увидеть что описательные статистики совпадают. Что насчет распределения данных?

## Построим графики распределения значений

```{r}
#| code-fold: true
#| code-summary: "Show the code"
# отрисовываем графики по очереди
p1 <- ggplot(anscombe, aes(x1,y1))+
  geom_point(size = 3.5, fill = 'darkorange', color= 'orangered', 
             alpha = 0.8, shape = 21)+
  labs(
       title = "Dataset 1" ) +
  geom_smooth(se = FALSE, method = "lm", formula = "y ~ x", size = 0.8, alpha = 0.9)+
  theme_bw()

p2 <- ggplot(anscombe, aes(x2,y2))+
  geom_point(size = 3.5, fill = 'darkorange', color= 'orangered', 
             alpha = 0.8, shape = 21)+
  labs(title = "Dataset 2" ) +
  geom_smooth(se = FALSE, method = "lm", formula = "y ~ x", 
              size = 0.8, alpha = 0.9)+
  theme_bw()
p3 <- ggplot(anscombe, aes(x3,y3))+
   geom_point(size = 3.5, fill = 'darkorange', color= 'orangered', 
             alpha = 0.8, shape = 21)+
  labs(title = "Dataset 3" ) +
  geom_smooth(se = FALSE, method = "lm", formula = "y ~ x", 
              size = 0.8, alpha = 0.9)+
  theme_bw()
p4 <- ggplot(anscombe, aes(x4,y4))+
   geom_point(size = 3.5, fill = 'darkorange', color= 'orangered', 
             alpha = 0.8, shape = 21)+
  labs(title = "Dataset 4" ) +
  geom_smooth(se = FALSE, method = "lm", formula = "y ~ x", 
              size = 0.8, alpha = 0.9)+
  theme_bw()
# объединяем их в один плот с помощью библиотеки `patchwork`
(p1 | p2) / (p3 | p4)

```

Итак, как и было обещано, распределения данных оказались совершенно разными. Подчеркну еще раз важность визуализации данных перед началом анализа. Причем именно рекомендую строить диаграммы рассеяния (scatter plot) как в коде, приведенном выше, а не опираться только на боксплоты (boxplot), к примеру. Боксплоты сокращают информацию о данных, хотя и являются стандартом на конференциях и в публикациях. Про это можно почитать [здесь](https://nightingaledvs.com/ive-stopped-using-box-plots-should-you/).

## Список источников

1.  Anscombe, F. J. (1973). "Graphs in Statistical Analysis". *American Statistician*. **27** (1): 17--21. [doi](https://en.wikipedia.org/wiki/Doi_(identifier) "Doi (identifier)"):[10.1080/00031305.1973.10478966](https://doi.org/10.1080%2F00031305.1973.10478966)
